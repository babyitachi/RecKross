file path:  ./data/
Reading data...
Taken 7.30182147026062 seconds
data matrix loaded
num of users: 6040
num of movies: 3706
num of training ratings: 900189
num of test ratings: 100020
Data read complete.
Config:  {'n_hid': 500, 'n_dep': 5, 'n_dim': 5, 'k_len': 3, 'n_layers': 3, 'max_epoch_p': 140, 'patience_p': 10, 'tol_p': 0.0001, 'lambda_2': 44, 'lambda_s': 0.0006291, 'lambda_kernal': 0.03046, 'lr': 0.98, 'optim_type': 'LBFGS', 'drop': 0.65, 'n_u': 6040, 'n_m': 3706}
.-^-._.-^-._.-^-._.-^-._ Training Started .-^-._.-^-._.-^-._.-^-._.-^-._
Device:  cuda:0
Optimizer: LBFGS
Model:  RecKross(
  (layers): ModuleList(
    (0): KernelLayer(
      (activation): Sigmoid()
    )
    (1): KCrossKernelLayer(
      (activation): ReLU()
    )
    (2): KernelLayer(
      (activation): Identity()
    )
  )
  (dropout): Dropout(p=0.65, inplace=False)
)
Loss: sqE + 0.351*reg_loss
.-^-._.-^-._.-^-._.-^-._.-^-._.-^-._.-^-._.-^-._.-^-._.-^-._.-^-._.-^-._
Epoch: 1 test rmse: 1.01216 train rmse: 1.0056658
Epoch: 2 test rmse: 1.0034376 train rmse: 0.99604297
Epoch: 3 test rmse: 0.9976717 train rmse: 0.9902889
Epoch: 4 test rmse: 0.9913203 train rmse: 0.9844791
Epoch: 5 test rmse: 0.9899761 train rmse: 0.98363614
Epoch: 6 test rmse: 0.9905009 train rmse: 0.9841522
Epoch: 7 test rmse: 0.99071777 train rmse: 0.9839561
Epoch: 8 test rmse: 0.98503065 train rmse: 0.9769964
Epoch: 9 test rmse: 0.97441584 train rmse: 0.965343
Epoch: 10 test rmse: 0.9716512 train rmse: 0.96222925
Epoch: 11 test rmse: 0.9776766 train rmse: 0.9635451
Epoch: 12 test rmse: 1.3740474 train rmse: 1.3694991
Epoch: 13 test rmse: 0.9182404 train rmse: 0.9084206
Epoch: 14 test rmse: 0.90625453 train rmse: 0.89604896
Epoch: 15 test rmse: 0.8986838 train rmse: 0.88724434
Epoch: 16 test rmse: 0.8894219 train rmse: 0.87628525
Epoch: 17 test rmse: 0.8837978 train rmse: 0.8685869
Epoch: 18 test rmse: 0.87822264 train rmse: 0.8606246
Epoch: 19 test rmse: 0.87369657 train rmse: 0.85362357
Epoch: 20 test rmse: 0.87013286 train rmse: 0.84801584
Epoch: 21 test rmse: 0.86727023 train rmse: 0.84354985
Epoch: 22 test rmse: 0.86533004 train rmse: 0.8406018
Epoch: 23 test rmse: 0.8630916 train rmse: 0.8368586
Epoch: 24 test rmse: 0.8619274 train rmse: 0.833735
Epoch: 25 test rmse: 0.86025625 train rmse: 0.8304909
Epoch: 26 test rmse: 0.8584458 train rmse: 0.8271682
Epoch: 27 test rmse: 0.85673386 train rmse: 0.824235
Epoch: 28 test rmse: 0.8559054 train rmse: 0.82222426
Epoch: 29 test rmse: 0.8544782 train rmse: 0.8194126
Epoch: 30 test rmse: 0.8539251 train rmse: 0.81725025
Epoch: 31 test rmse: 0.852247 train rmse: 0.8140828
Epoch: 32 test rmse: 0.8507778 train rmse: 0.81095815
Epoch: 33 test rmse: 0.8500118 train rmse: 0.80894214
Epoch: 34 test rmse: 0.8493643 train rmse: 0.80608433
Epoch: 35 test rmse: 0.84858036 train rmse: 0.8037874
Epoch: 36 test rmse: 0.84701765 train rmse: 0.80111414
Epoch: 37 test rmse: 0.8464815 train rmse: 0.79919523
Epoch: 38 test rmse: 0.84608895 train rmse: 0.7981772
Epoch: 39 test rmse: 0.8456839 train rmse: 0.7967617
Epoch: 40 test rmse: 0.8446293 train rmse: 0.79423934
Epoch: 41 test rmse: 0.84417564 train rmse: 0.7927458
Epoch: 42 test rmse: 0.8433798 train rmse: 0.7909634
Epoch: 43 test rmse: 0.8428278 train rmse: 0.7891696
Epoch: 44 test rmse: 0.842328 train rmse: 0.78730744
Epoch: 45 test rmse: 0.84178096 train rmse: 0.7855306
Epoch: 46 test rmse: 0.84105223 train rmse: 0.7842502
Epoch: 47 test rmse: 0.84068096 train rmse: 0.78287435
Epoch: 48 test rmse: 0.8402763 train rmse: 0.781337
Epoch: 49 test rmse: 0.8394024 train rmse: 0.77876234
Epoch: 50 test rmse: 0.8391468 train rmse: 0.77750146
Epoch: 51 test rmse: 0.8385998 train rmse: 0.7757251
Epoch: 52 test rmse: 0.8384309 train rmse: 0.7740592
Epoch: 53 test rmse: 0.83799815 train rmse: 0.7721465
Epoch: 54 test rmse: 0.8374114 train rmse: 0.77144724
Epoch: 55 test rmse: 0.83705753 train rmse: 0.7692983
Epoch: 56 test rmse: 0.83696127 train rmse: 0.7680682
Epoch: 57 test rmse: 0.83648497 train rmse: 0.7668047
Epoch: 58 test rmse: 0.83602285 train rmse: 0.76446927
Epoch: 59 test rmse: 0.8354075 train rmse: 0.76252687
Epoch: 60 test rmse: 0.83491075 train rmse: 0.7615901
Epoch: 61 test rmse: 0.8347178 train rmse: 0.7591662
Epoch: 62 test rmse: 0.8339631 train rmse: 0.7566788
Epoch: 63 test rmse: 0.83374494 train rmse: 0.7559166
Epoch: 64 test rmse: 0.83321315 train rmse: 0.7543487
Epoch: 65 test rmse: 0.8332031 train rmse: 0.75302696
Epoch: 66 test rmse: 0.83274066 train rmse: 0.75211364
Epoch: 67 test rmse: 0.83237517 train rmse: 0.7501353
Epoch: 68 test rmse: 0.83234763 train rmse: 0.7496583
Epoch: 69 test rmse: 0.8318584 train rmse: 0.74781984
Epoch: 70 test rmse: 0.83174974 train rmse: 0.7461205
Epoch: 71 test rmse: 0.8311485 train rmse: 0.74381423
Epoch: 72 test rmse: 0.83106726 train rmse: 0.74340487
Epoch: 73 test rmse: 0.83053887 train rmse: 0.74173415
Epoch: 74 test rmse: 0.83052593 train rmse: 0.7397842
Epoch: 75 test rmse: 0.83006036 train rmse: 0.73831296
Epoch: 76 test rmse: 0.82982117 train rmse: 0.7364461
Epoch: 77 test rmse: 0.82998073 train rmse: 0.7349253
Epoch: 78 test rmse: 0.8294155 train rmse: 0.7326557
Epoch: 79 test rmse: 0.8292494 train rmse: 0.73109066
Epoch: 80 test rmse: 0.8288937 train rmse: 0.7293816
Epoch: 81 test rmse: 0.8284632 train rmse: 0.72798467
Epoch: 82 test rmse: 0.8284958 train rmse: 0.72733957
Epoch: 83 test rmse: 0.8282514 train rmse: 0.72573024
Epoch: 84 test rmse: 0.82843006 train rmse: 0.72548074
Epoch: 85 test rmse: 0.8279828 train rmse: 0.7223621
Epoch: 86 test rmse: 0.82778883 train rmse: 0.72115386
Epoch: 87 test rmse: 0.8276191 train rmse: 0.7204745
Epoch: 88 test rmse: 0.8276418 train rmse: 0.7186698
Epoch: 89 test rmse: 0.82716745 train rmse: 0.7167256
Epoch: 90 test rmse: 0.8266577 train rmse: 0.71511954
Epoch: 91 test rmse: 0.82657796 train rmse: 0.7132652
Epoch: 92 test rmse: 0.82653934 train rmse: 0.711917
Epoch: 93 test rmse: 0.82637113 train rmse: 0.71066284
Epoch: 94 test rmse: 0.82606363 train rmse: 0.7089195
Epoch: 95 test rmse: 0.8260962 train rmse: 0.70700353
Epoch: 96 test rmse: 0.8259282 train rmse: 0.70565295
Epoch: 97 test rmse: 0.8258018 train rmse: 0.7048418
Epoch: 98 test rmse: 0.82541835 train rmse: 0.70342565
Epoch: 99 test rmse: 0.82532823 train rmse: 0.7011204
Epoch: 100 test rmse: 0.82527983 train rmse: 0.7005072
Epoch: 101 test rmse: 0.82508326 train rmse: 0.69818956
Epoch: 102 test rmse: 0.82498866 train rmse: 0.69769317
Epoch: 103 test rmse: 0.82474643 train rmse: 0.69498634
Epoch: 104 test rmse: 0.8247966 train rmse: 0.69465077
Epoch: 105 test rmse: 0.8244873 train rmse: 0.6925828
Epoch: 106 test rmse: 0.8240285 train rmse: 0.6902302
Epoch: 107 test rmse: 0.8246583 train rmse: 0.68919057
Epoch: 108 test rmse: 0.8243733 train rmse: 0.68710285
Epoch: 109 test rmse: 0.82410395 train rmse: 0.6867552
Epoch: 110 test rmse: 0.8239925 train rmse: 0.68553823
Epoch: 111 test rmse: 0.82409084 train rmse: 0.6842288
Epoch: 112 test rmse: 0.82395935 train rmse: 0.6822865
Epoch: 113 test rmse: 0.8238191 train rmse: 0.67987925
Epoch: 114 test rmse: 0.8237621 train rmse: 0.678412
Epoch: 115 test rmse: 0.8238112 train rmse: 0.6774376
Epoch: 116 test rmse: 0.8235947 train rmse: 0.67661315
Epoch: 117 test rmse: 0.82359314 train rmse: 0.67557
Epoch: 118 test rmse: 0.8233935 train rmse: 0.672697
Epoch: 119 test rmse: 0.8236387 train rmse: 0.671631
Epoch: 120 test rmse: 0.82358754 train rmse: 0.6706834
Epoch: 121 test rmse: 0.8236515 train rmse: 0.6690882
Epoch: 122 test rmse: 0.8232012 train rmse: 0.6663183
Epoch: 123 test rmse: 0.82350266 train rmse: 0.6649612
Epoch: 124 test rmse: 0.8232606 train rmse: 0.664209
Epoch: 125 test rmse: 0.82322824 train rmse: 0.66311985
Epoch: 126 test rmse: 0.823555 train rmse: 0.6609429
Epoch: 127 test rmse: 0.8230225 train rmse: 0.6595665
Epoch: 128 test rmse: 0.82346565 train rmse: 0.6593291
Epoch: 129 test rmse: 0.8229108 train rmse: 0.6579221
Epoch: 130 test rmse: 0.8229461 train rmse: 0.65618783
Epoch: 131 test rmse: 0.8229568 train rmse: 0.6553225
Epoch: 132 test rmse: 0.82327664 train rmse: 0.65356934
Epoch: 133 test rmse: 0.82240725 train rmse: 0.65237385
Epoch: 134 test rmse: 0.8232467 train rmse: 0.6519488
Epoch: 135 test rmse: 0.82259315 train rmse: 0.6509048
Epoch: 136 test rmse: 0.8228805 train rmse: 0.6485329
Epoch: 137 test rmse: 0.8230306 train rmse: 0.6475755
Epoch: 138 test rmse: 0.8226984 train rmse: 0.647642
Epoch: 139 test rmse: 0.82285136 train rmse: 0.64484876
Epoch: 140 test rmse: 0.82298446 train rmse: 0.643889
.-^-._.-^-._.-^-._.-^-._.-^-._.-^-._.-^-._.-^-._.-^-._.-^-._.-^-._.-^-._
Time cumulative: 2052.844906568527 seconds
.-^-._.-^-._.-^-._.-^-._ Training Finished .-^-._.-^-._.-^-._.-^-._.-^-._
Best Epoch:  133  Best RMSE:  0.82240725
